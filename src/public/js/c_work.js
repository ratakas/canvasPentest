$(document).ready(function() {

    

    $('#sn_info').summernote({
        disableDragAndDrop: true,
        placeholder: 'Hello bootstrap 4',
        tabsize: 0.5,
        height: 200,
        blockquoteBreakingLevel: 2,
        lineHeight: 5
      });
      $('#sn_notes').summernote({
        disableDragAndDrop: true,
        placeholder: 'notas',
        toolbar: [
            // [groupName, [list of button]]
            ['style', ['bold', 'italic', 'underline', 'clear']],
            ['fontsize', ['fontname','fontsize',]],
            ['para', ['ul', 'ol', 'paragraph']]
        ],
        height:200
      });
      $('#sn_all').summernote({
        disableDragAndDrop: true,
        placeholder: 'notas',
        toolbar: [
            // [groupName, [list of button]]
            ['style', ['style','bold', 'italic', 'underline', 'clear']],
            ['fontsize', ['fontname','fontsize',]],
            ['para', ['ul', 'ol', 'paragraph']],
            ['para', ['height', 'hr', 'table', 'picture', 'link', 'video', 'redo', 'undo', 'codeview', 'fullscreen']]
        ],
        height:500
      });
      
      

      $("#updatework").click(function() {
        var dataup={                    
            "name" : $("#w_name").text(),
            "host": $("#w_host").text(),
            "inforelevant": $("#sn_info").summernote('code'),
            "inforeview": $("#sn_notes").summernote('code'),
            "infoall": $("#sn_all").summernote('code'),
            "state": true
        };

        console.log(dataup);
        $.ajax({
            url: '/works/'+$("#w_id").text(),
            type: 'put',
            dataType: 'json',
            contentType: 'application/json',
            data: JSON.stringify(dataup),
            success: (result)=>{
                console.log("datos del work save");
                msmnotication(true,'Update');                
            },
            error: (result)=>{
                console.log(result);
                msmnotication(false,'Update');
                
            }
        });
        });

      $("#savework").click(function() {
        
        var dataspace={
            "name" : $("#ws_name").text(),
            "type" : true
        }
        console.log(dataspace)
        
        $.ajax({
            url: '/workspace',
            type: 'post',
            dataType: 'json',
            contentType: 'application/json',
            data: JSON.stringify(dataspace),
            success: (result)=>{
                console.log(result)
                //create work
                var datawork={                    
                        "name" : $("#w_name").text(),
                        "host": $("#w_host").text(),
                        "inforelevant": $("#sn_info").summernote('code'),
                        "inforeview": $("#sn_notes").summernote('code'),
                        "infoall": $("#sn_all").summernote('code'),
                        "creationdate": "na",
                        "state": true,
                        "worksapce_id": result.id
                };

                
                $.ajax({
                    url: '/works',
                    type: 'post',
                    dataType: 'json',
                    contentType: 'application/json',
                    data: JSON.stringify(datawork),
                    success: (result2)=>{
                        $("#savework").hide();
                        $("#updatework").show();  
                        $("#w_id").text(result2.id);                     
                        $("#ws_id").text(result.id);
                        $("#btn_w_html").attr("href","/report/"+result2.id);
                        $("#btn_w_pdf").attr("href","/reportpdf/"+result2.id);
                        $("#btn_w_use").attr("href","/workuse/"+result.id+"/"+result2.id);
                        
                        msmnotication(true,'Create');
                                             
                    },
                    error: (result)=>{
                        console.log(result);
                        msmnotication(false,'Create');
                        
                    }
                });
            },
            error: (result)=>{
                console.log(result)
            }
        });
        
      });

});


function msmnotication(type,msm){

    /**
     * <script src="tools/toast2/bootstrap-notify.min.js"></script>
     * msmnotication(true,'Create');
     * msmnotication(false,'Create');
     * msmnotication(true,'Update');
     */
    
    if(type){
        $.notify({
            message: msm+" successfully !!"
        },{
            type: 'success',
            delay: 300,    
            animate: {
                enter: 'animated fadeInRight',
                exit: 'animated fadeOutRight'
            }
        }
        );

    }else if(!type){
        $.notify({
            message: "Error to "+msm+" !!"
        },{
            type: 'danger',
            delay: 300,    
            animate: {
                enter: 'animated fadeInRight',
                exit: 'animated fadeOutRight'
            }
        }
        );
    }
}