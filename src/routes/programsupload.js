import path from 'path';

const multer = require('multer');

module.exports = app =>{
let reqPath = path.join(__dirname, '../');

let nombrefile;

var storage = multer.diskStorage({
    destination: function (req, file, cb) {
      cb(null, path.join(reqPath+'public/uploads'))
    },
    filename: function (req, file, cb) {
        //let extArray = file.mimetype.toString().split("/");
        //let extension = extArray[extArray.length - 1];
       nombrefile = Date.now()+'-'+file.originalname;
      cb(null, nombrefile);
    }
  })
  
  var upload = multer({ storage: storage })

app.post('/uploadfile', upload.single('myFile'), (req, res, next) => {
    const file = req.file
    if (!file) {
      const error = new Error('Please upload a file')
      error.httpStatusCode = 400
      return next(error)
  
    }
      //7res.send(file)
    res.send(nombrefile);
  })

}